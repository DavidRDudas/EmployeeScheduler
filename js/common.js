window.scheduleData=JSON.parse(localStorage.getItem("scheduleData"))||[],window.projects=JSON.parse(localStorage.getItem("projects"))||{},window.markets=JSON.parse(localStorage.getItem("markets"))||[],window.employees=JSON.parse(localStorage.getItem("employees"))||{},window.saveData=function(){localStorage.setItem("scheduleData",JSON.stringify(window.scheduleData)),localStorage.setItem("projects",JSON.stringify(window.projects)),localStorage.setItem("markets",JSON.stringify(window.markets)),localStorage.setItem("employees",JSON.stringify(window.employees))},window.exportData=function(){const e={scheduleData:window.scheduleData,projects:window.projects,markets:window.markets,employees:window.employees,ptoColor:localStorage.getItem("ptoColor")||"#ffcdd2",version:"1.0"},o=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(o),a=document.createElement("a");a.href=t,a.download=`backup_${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},window.importData=function(e){const o=new FileReader;o.onload=function(e){try{const o=JSON.parse(e.target.result);if(!(o.version&&o.scheduleData&&o.projects&&o.markets&&o.employees))throw new Error("Invalid backup file format");confirm("This will overwrite all existing data. Are you sure you want to continue?")&&(window.scheduleData=o.scheduleData,window.projects=o.projects,window.markets=o.markets,window.employees=o.employees,o.ptoColor&&localStorage.setItem("ptoColor",o.ptoColor),window.saveData(),alert("Data imported successfully! The page will now reload."),location.reload())}catch(e){alert("Error importing data: "+e.message)}},o.readAsText(e)},window.getPTOColor=function(){return localStorage.getItem("ptoColor")||"#ffcdd2"},window.getColorPreference=function(){return localStorage.getItem("calendarColorPreference")||"employee"},window.setColorPreference=function(e){localStorage.setItem("calendarColorPreference",e),window.dispatchEvent(new Event("colorPreferenceChanged"))},window.getContinuousBlocks=function(){return"true"===localStorage.getItem("continuousBlocks")},window.setContinuousBlocks=function(e){localStorage.setItem("continuousBlocks",e),window.dispatchEvent(new Event("continuousBlocksChanged"))};
